#!/usr/bin/env python
import optparse, sys
import RPi.GPIO as io
import os

try:
  import pwd
except ImportError:
  import getpass
  pwd = None

def current_user():
  if pwd:
    return pwd.getpwuid(os.geteuid()).pw_name
  else:
    return getpass.getuser()

def main():
  p = optparse.OptionParser()
  options, arguments = p.parse_args()

  if not arguments:
    print 'Specify power state with on or off'
    sys.exit(0)

  if current_user() != 'root':
    print 'You must be sudo to run'
    sys.exit(0)

  setup()
  power(arguments[0] == 'on')


def setup():
  io.setmode(io.BCM)
  io.setup(24, io.OUT)


def power(state):
  io.output(24, state==True)
  'Power is'.format( ('off','on')[state==True] )



if __name__ == '__main__':
  main()